<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Locals – Mappe umane (MVP)</title>
  <meta name="description" content="Scopri mappe curate da Local fittizi per Milano e Roma: sblocca la mappa inserendo la tua email.">

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  <style>
    :root{
      --bg:#ffffff;--text:#16171c;--muted:#5f6474;
      --accent:#7b6df0;--accent2:#a78bfa;--border:#e7e9f4;
      --card:#fafaff;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;color:var(--text)}
    .container{max-width:1100px;margin:auto;padding:24px}

    /* header */
    .header{display:flex;justify-content:space-between;align-items:center}
    .badge{border:1px solid var(--border);padding:4px 10px;border-radius:999px;font-size:12px;color:var(--muted)}
    .hero{margin:24px 0}
    .hero h1{margin:0;font-size:30px}
    .hero p{color:var(--muted);max-width:700px}

    /* cards */
    .section-title{margin:18px 0 10px;font-size:22px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:18px}
    .card{background:#fff;border:1px solid var(--border);border-radius:18px;overflow:hidden;cursor:pointer;transition:transform .1s ease,box-shadow .1s ease}
    .card:hover{transform:translateY(-2px);box-shadow:0 6px 18px rgba(0,0,0,.06)}
    .cover{aspect-ratio:16/10;width:100%;object-fit:cover}
    .card-body{padding:16px}
    .name{font-weight:700;margin:0 0 4px}
    .subtitle{color:var(--muted);font-size:13px;margin:0 0 8px}
    .chips{display:flex;flex-wrap:wrap;gap:6px}
    .pill{background:#f0efff;border:1px solid #e3e1ff;color:#3c3a6a;padding:6px 10px;border-radius:999px;font-size:12px}
    .footer{margin-top:30px;color:#8a93a8;font-size:13px}

    /* modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;place-items:center;z-index:100}
    .modal{width:min(780px,95%);background:#fff;border-radius:20px;overflow:hidden}
    .modal-head{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
    .modal-body{padding:18px;display:flex;flex-direction:column;gap:18px}
    .modal img{width:100%;border-radius:14px;aspect-ratio:16/10;object-fit:cover}
    .modal h2{margin:10px 0 4px;font-size:22px}
    .modal p{margin:0 0 12px;line-height:1.5}
    .close{cursor:pointer;font-size:20px;border:none;background:none;color:#666}
    .keywords{display:flex;flex-wrap:wrap;gap:8px;margin-top:6px}
    .keyword{padding:6px 12px;border-radius:999px;border:1px solid var(--border);cursor:pointer;font-size:13px;background:#fafaff}
    .keyword.active{background:var(--accent);color:white;border-color:var(--accent)}
    .form{display:flex;flex-direction:column;gap:12px}
    input[type=email]{padding:10px;border:1px solid var(--border);border-radius:10px;font-size:15px}
    .btn{padding:10px 14px;border-radius:12px;font-weight:600;cursor:pointer}
    .btn-primary{background:linear-gradient(90deg,var(--accent),#60a5fa);border:none;color:#fff}
    #map{height:420px;border-radius:14px;border:1px solid var(--border)}

    .hidden{display:none!important}
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <img src="logo.png" alt="Locals" style="height:36px">
      <div class="badge">MVP di validazione</div>
    </header>

    <section class="hero">
      <h1>Mappe umane per viaggiare meglio</h1>
      <p>Scopri le città attraverso chi le vive. Leggi il profilo, e sblocca la mappa personalizzata dopo aver inserito la tua email.</p>
    </section>

    <section id="cards"></section>
    <footer class="footer">© Locals – prototipo di validazione.</footer>
  </div>

  <!-- modal -->
  <div id="modal" class="modal-backdrop">
    <div class="modal">
      <div class="modal-head">
        <div>
          <div id="modalTitle" style="font-weight:700"></div>
          <div id="modalSubtitle" style="font-size:13px;color:#6a6f82"></div>
        </div>
        <button id="modalClose" class="close">✕</button>
      </div>
      <div class="modal-body">
        <img id="modalCover" src="" alt="">
        <p id="modalAbout"></p>

        <div class="keywords" id="keywords"></div>

        <form id="unlockForm" class="form">
          <input id="email" type="email" placeholder="Inserisci la tua email per sbloccare" required>
          <button type="submit" id="btnUnlock" class="btn btn-primary">Sblocca mappa</button>
        </form>

        <div id="map" class="hidden"></div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script>
    const SUBMIT_ENDPOINT = "";

    const img = (seed) => `https://unsplash.it/600/400?image=${seed}`;
    const MAPS = [
      { id:"mi-giulia", city:"Milano", title:"Giulia – Foodie & Design", cover:img(1001),
        subtitle:"Product designer e pasticcerie d’autore",
        about:`Pasticcerie, bookshop, cortili nascosti e caffè curati. Milano da vivere con gusto.`,
        keywords:["Foodie","Design","Caffè","Brunch","Arte"],
        center:[45.463,9.189],
        poi:[[45.45,9.20],[45.47,9.21],[45.48,9.18]]
      },
      { id:"mi-luca", city:"Milano", title:"Luca – Tech & Alternative Night", cover:img(1005),
        subtitle:"Dev by day, clubber by night",
        about:`Dai coworking ai club nascosti tra Navigli e Isola. Milano alternativa e notturna.`,
        keywords:["Nightlife","Startups","Musica","Cocktail"],
        center:[45.463,9.189],
        poi:[[45.47,9.19],[45.45,9.17],[45.48,9.20]]
      },
      { id:"rm-sara", city:"Roma", title:"Sara – Classici & Nascosti", cover:img(1020),
        subtitle:"Archivista e cortili segreti",
        about:`Belvederi, logge e giardini romani: una Roma lenta e fotografica.`,
        keywords:["Storia","Fotografia","Giardini","Relax"],
        center:[41.9028,12.4964],
        poi:[[41.89,12.47],[41.90,12.48],[41.91,12.50]]
      },
      { id:"rm-davide", city:"Roma", title:"Davide – Street Food & Nightlife", cover:img(1027),
        subtitle:"Food trucker e nottambulo",
        about:`Supplì croccanti, piazze vive e birre artigianali. Roma da assaporare fino a tardi.`,
        keywords:["Street food","Nightlife","Birre","Aperitivi"],
        center:[41.9028,12.4964],
        poi:[[41.88,12.47],[41.90,12.48],[41.92,12.49]]
      }
    ];

    const cardsEl = document.getElementById('cards');
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modalTitle');
    const modalSubtitle = document.getElementById('modalSubtitle');
    const modalCover = document.getElementById('modalCover');
    const modalAbout = document.getElementById('modalAbout');
    const keywordsBox = document.getElementById('keywords');
    const unlockForm = document.getElementById('unlockForm');
    const emailInput = document.getElementById('email');
    const btnUnlock = document.getElementById('btnUnlock');
    const mapDiv = document.getElementById('map');

    let current = null, mapInstance=null, markers=[];

    function cardHtml(m){
      return `
      <article class="card" onclick="openModal('${m.id}')">
        <img class="cover" src="${m.cover}" alt="${m.title}">
        <div class="card-body">
          <h3 class="name">${m.title}</h3>
          <p class="subtitle">${m.subtitle}</p>
          <div class="chips">${m.keywords.map(k=>`<span class="pill">${k}</span>`).join('')}</div>
        </div>
      </article>`;
    }

    function renderCards(){
      const milano = MAPS.filter(x=>x.city==="Milano");
      const roma = MAPS.filter(x=>x.city==="Roma");
      cardsEl.innerHTML = `
        <h2 class="section-title">Milano</h2>
        <div class="grid">${milano.map(cardHtml).join('')}</div>
        <h2 class="section-title">Roma</h2>
        <div class="grid">${roma.map(cardHtml).join('')}</div>`;
    }

    function openModal(id){
      current = MAPS.find(x=>x.id===id);
      modalTitle.textContent = current.title;
      modalSubtitle.textContent = current.subtitle;
      modalCover.src = current.cover;
      modalAbout.textContent = current.about;
      mapDiv.classList.add('hidden');
      unlockForm.reset();
      renderKeywords();
      modal.style.display = 'grid';
    }

    function closeModal(){ modal.style.display='none'; }
    document.getElementById('modalClose')?.addEventListener('click',closeModal);
    document.getElementById('modalClose')?.addEventListener('touchstart',closeModal);
    document.getElementById('modalClose') || (document.getElementById('modalClose')?.addEventListener('click',closeModal));
    document.getElementById('modalClose') || document.querySelector('.close').addEventListener('click',closeModal);

    function renderKeywords(){
      keywordsBox.innerHTML = "";
      current.keywords.forEach(k=>{
        const el = document.createElement("div");
        el.textContent = k;
        el.className = "keyword";
        el.onclick = ()=>el.classList.toggle("active");
        keywordsBox.appendChild(el);
      });
    }

    unlockForm.addEventListener('submit',e=>{
      e.preventDefault();
      const email = emailInput.value.trim();
      if(!email) return alert("Inserisci un'email valida per sbloccare la mappa");
      showMap();
    });

    function showMap(){
      mapDiv.classList.remove('hidden');
      if(!mapInstance){
        mapInstance = L.map('map');
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19}).addTo(mapInstance);
      }
      markers.forEach(m=>m.remove());
      markers=[];
      mapInstance.setView(current.center,13);
      current.poi.forEach(p=>{
        const mk=L.marker(p).addTo(mapInstance);
        markers.push(mk);
      });
    }

    renderCards();
  </script>
</body>
</html>

